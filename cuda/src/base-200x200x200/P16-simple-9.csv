==25101== NVPROF is profiling process 25101, command: ./miniFE.x --num_devices 4 -nx 800 -ny 800 -nz 200
==25101== Profiling application: ./miniFE.x --num_devices 4 -nx 800 -ny 800 -nz 200
==25101== Profiling result:
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"GPU activities",76.378374,778.760173,201,3.874428,3.867207,3.889287,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE0ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"GPU activities",13.619598,138.866542,602,0.230675,0.159295,0.234142,"_ZN6miniFE13waxpby_kernelINS_9PODVectorIdiiEEEEvNT_10ScalarTypeES3_S4_S3_S3_"
"GPU activities",4.634140,47.250075,400,0.118125,0.084064,0.151999,"_ZN6miniFE10dot_kernelINS_9PODVectorIdiiEEEEvT_S3_PNS_10TypeTraitsINS3_10ScalarTypeEE14magnitude_typeE"
"GPU activities",3.304953,33.697573,201,0.167649,0.165918,0.173631,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE1ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"GPU activities",1.484617,15.137279,601,0.025186,0.001248,0.120736,"[CUDA memcpy DtoH]"
"GPU activities",0.418507,4.267136,201,0.021229,0.010496,0.032255,"_ZN6miniFE20copyElementsToBufferIdiEEvPT_S2_PT0_i"
"GPU activities",0.088893,0.906363,400,0.002265,0.002176,0.002912,"_ZN6miniFE23dot_final_reduce_kernelIdEEvPT_"
"GPU activities",0.047673,0.486077,400,0.001215,0.001151,0.001440,"_ZN6miniFE17cudaMemset_kernelIdEEvPT_S1_i"
"GPU activities",0.023243,0.236990,4,0.059247,0.001312,0.079967,"_ZN6thrust8cuda_cub4core13_kernel_agentINS0_14__parallel_for16ParallelForAgentINS0_20__uninitialized_fill7functorINS_10device_ptrIdEEdEEmEES9_mEEvT0_T1_"
"API calls",76.462890,510.631810,601,0.849636,0.034192,4.985795,"cudaEventSynchronize"
"API calls",14.513221,96.921686,2409,0.040233,0.020206,11.208206,"cudaLaunchKernel"
"API calls",3.829779,25.575898,4,6.393974,0.042758,8.773284,"cudaMalloc"
"API calls",2.407330,16.076547,601,0.026749,0.017630,0.046752,"cudaMemcpyAsync"
"API calls",1.263584,8.438420,3,2.812806,2.449479,3.248555,"cudaFree"
"API calls",0.669694,4.472328,802,0.005576,0.003408,0.082624,"cudaEventRecord"
"API calls",0.359018,2.397584,402,0.005964,0.003330,0.013564,"cudaStreamWaitEvent"
"API calls",0.310570,2.074041,2009,0.001032,0.000539,0.007101,"cudaGetLastError"
"API calls",0.089286,0.596264,3,0.198754,0.055740,0.466738,"cudaHostRegister"
"API calls",0.075164,0.501955,2,0.250977,0.042676,0.459279,"cudaHostUnregister"
"API calls",0.014227,0.095012,4,0.023753,0.019081,0.026393,"cudaFuncGetAttributes"
"API calls",0.002229,0.014885,4,0.003721,0.002730,0.004479,"cudaGetDevice"
"API calls",0.001832,0.012234,4,0.003058,0.002589,0.003379,"cudaDeviceGetAttribute"
"API calls",0.001177,0.007858,8,0.000982,0.000605,0.001685,"cudaPeekAtLastError"

==25101== NVTX result:
==25101==   Thread "<unnamed>" (id = 312240)
==25101==     Domain "<unnamed>"
==25101==       Range "Allocation of Temporary Vectors"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,82.975331,1,82.975331,82.975331,82.975331,"Allocation of Temporary Vectors"
"GPU activities",100.000000,0.235678,3,0.078559,0.077440,0.079967,"_ZN6thrust8cuda_cub4core13_kernel_agentINS0_14__parallel_for16ParallelForAgentINS0_20__uninitialized_fill7functorINS_10device_ptrIdEEdEEmEES9_mEEvT0_T1_"
"API calls",100.000000,11.328789,3,3.776263,0.059044,11.208206,"cudaLaunchKernel"

==25101==       Range "Create external_local_index"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,2.231156,1,2.231156,2.231156,2.231156,"Create external_local_index"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "MPI All Reduce"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,76.211968,401,0.190054,0.009933,13.559082,"MPI All Reduce"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "MPI Communication"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,30.243762,2,15.121881,1.396492,28.847270,"MPI Communication"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "MPI Reduce"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,37.311016,1,37.311016,37.311016,37.311016,"MPI Reduce"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "Set External Processors"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,35.952533,1,35.952533,35.952533,35.952533,"Set External Processors"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "add to recv_list"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,0.001442,1,0.001442,0.001442,0.001442,"add to recv_list"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "allocate device memory"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,66.703260,1,66.703260,66.703260,66.703260,"allocate device memory"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "allocate host memory"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,194.676892,1,194.676892,194.676892,194.676892,"allocate host memory"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "allocation"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,3.370454,1,3.370454,3.370454,3.370454,"allocation"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "assemble FE data"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,165.602112,1,165.602112,165.602112,165.602112,"assemble FE data"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "assign new external"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,1.019846,2,0.509923,0.135287,0.884559,"assign new external"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "begin exchange"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,20.377698,201,0.101381,0.081293,0.180099,"begin exchange"
"GPU activities",77.402782,14.616321,201,0.072718,0.047616,0.120736,"[CUDA memcpy DtoH]"
"GPU activities",22.597218,4.267136,201,0.021229,0.010496,0.032255,"_ZN6miniFE20copyElementsToBufferIdiEEvPT_S2_PT0_i"
"API calls",57.288571,7.221795,201,0.035929,0.028586,0.045117,"cudaLaunchKernel"
"API calls",42.711429,5.384201,201,0.026787,0.017747,0.046752,"cudaMemcpyAsync"

==25101==       Range "cgsolve"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,1302.102067,1,1302.102067,1302.102067,1302.102067,"cgsolve"
"GPU activities",76.378374,778.760173,201,3.874428,3.867207,3.889287,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE0ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"GPU activities",13.619598,138.866542,602,0.230675,0.159295,0.234142,"_ZN6miniFE13waxpby_kernelINS_9PODVectorIdiiEEEEvNT_10ScalarTypeES3_S4_S3_S3_"
"GPU activities",4.634140,47.250075,400,0.118125,0.084064,0.151999,"_ZN6miniFE10dot_kernelINS_9PODVectorIdiiEEEEvT_S3_PNS_10TypeTraitsINS3_10ScalarTypeEE14magnitude_typeE"
"GPU activities",3.304953,33.697573,201,0.167649,0.165918,0.173631,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE1ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"GPU activities",1.484617,15.137279,601,0.025186,0.001248,0.120736,"[CUDA memcpy DtoH]"
"GPU activities",0.418507,4.267136,201,0.021229,0.010496,0.032255,"_ZN6miniFE20copyElementsToBufferIdiEEvPT_S2_PT0_i"
"GPU activities",0.088893,0.906363,400,0.002265,0.002176,0.002912,"_ZN6miniFE23dot_final_reduce_kernelIdEEvPT_"
"GPU activities",0.047673,0.486077,400,0.001215,0.001151,0.001440,"_ZN6miniFE17cudaMemset_kernelIdEEvPT_S1_i"
"GPU activities",0.023243,0.236990,4,0.059247,0.001312,0.079967,"_ZN6thrust8cuda_cub4core13_kernel_agentINS0_14__parallel_for16ParallelForAgentINS0_20__uninitialized_fill7functorINS_10device_ptrIdEEdEEmEES9_mEEvT0_T1_"
"API calls",85.772745,96.921686,2409,0.040233,0.020206,11.208206,"cudaLaunchKernel"
"API calls",14.227255,16.076547,601,0.026749,0.017630,0.046752,"cudaMemcpyAsync"

==25101==       Range "create recv list"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,0.916855,1,0.916855,0.916855,0.916855,"create recv list"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "create tmp_neighbors"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,1.378276,1,1.378276,1.378276,1.378276,"create tmp_neighbors"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "end exchange"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,902.146825,201,4.488292,1.293755,5.182187,"end exchange"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "exterier region"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,8.451091,201,0.042045,0.030137,0.050252,"exterier region"
"GPU activities",100.000000,33.697573,201,0.167649,0.165918,0.173631,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE1ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"API calls",100.000000,7.589474,201,0.037758,0.026841,0.044937,"cudaLaunchKernel"

==25101==       Range "generate matrix structure"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,469.924602,1,469.924602,469.924602,469.924602,"generate matrix structure"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "impose boundary conditions"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,25.166775,1,25.166775,25.166775,25.166775,"impose boundary conditions"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "interier region"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,8.037768,201,0.039988,0.031246,0.046951,"interier region"
"GPU activities",100.000000,778.760173,201,3.874428,3.867207,3.889287,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE0ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"API calls",100.000000,7.309171,201,0.036364,0.028110,0.043336,"cudaLaunchKernel"

==25101==       Range "make local matrix"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,153.184574,1,153.184574,153.184574,153.184574,"make local matrix"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25101==       Range "reserve space in A"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,99.930257,1,99.930257,99.930257,99.930257,"reserve space in A"
No kernels were profiled in this range.
No API activities were profiled in this range.

