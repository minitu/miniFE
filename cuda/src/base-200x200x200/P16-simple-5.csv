==25099== NVPROF is profiling process 25099, command: ./miniFE.x --num_devices 4 -nx 800 -ny 800 -nz 200
==25099== Profiling application: ./miniFE.x --num_devices 4 -nx 800 -ny 800 -nz 200
==25099== Profiling result:
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"GPU activities",75.909992,763.167551,201,3.796853,3.789496,3.805336,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE0ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"GPU activities",13.564650,136.373364,602,0.226533,0.155838,0.230141,"_ZN6miniFE13waxpby_kernelINS_9PODVectorIdiiEEEEvNT_10ScalarTypeES3_S4_S3_S3_"
"GPU activities",4.620878,46.456392,400,0.116140,0.082943,0.149662,"_ZN6miniFE10dot_kernelINS_9PODVectorIdiiEEEEvT_S3_PNS_10TypeTraitsINS3_10ScalarTypeEE14magnitude_typeE"
"GPU activities",3.750366,37.704619,201,0.187585,0.184830,0.190462,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE1ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"GPU activities",1.594801,16.033467,601,0.026677,0.001248,0.150239,"[CUDA memcpy DtoH]"
"GPU activities",0.399235,4.013738,201,0.019968,0.012000,0.031424,"_ZN6miniFE20copyElementsToBufferIdiEEvPT_S2_PT0_i"
"GPU activities",0.089217,0.896949,400,0.002242,0.002144,0.002592,"_ZN6miniFE23dot_final_reduce_kernelIdEEvPT_"
"GPU activities",0.047470,0.477243,400,0.001193,0.001120,0.001600,"_ZN6miniFE17cudaMemset_kernelIdEEvPT_S1_i"
"GPU activities",0.023391,0.235165,4,0.058791,0.001632,0.080287,"_ZN6thrust8cuda_cub4core13_kernel_agentINS0_14__parallel_for16ParallelForAgentINS0_20__uninitialized_fill7functorINS_10device_ptrIdEEdEEmEES9_mEEvT0_T1_"
"API calls",74.065571,444.098982,601,0.738933,0.056439,3.962688,"cudaEventSynchronize"
"API calls",15.882983,95.234757,2409,0.039532,0.021447,11.112448,"cudaLaunchKernel"
"API calls",4.457189,26.725412,4,6.681353,0.030860,8.943602,"cudaMalloc"
"API calls",2.626341,15.747606,601,0.026202,0.016851,0.047719,"cudaMemcpyAsync"
"API calls",1.285489,7.707822,3,2.569274,2.211856,2.807277,"cudaFree"
"API calls",0.730124,4.377841,802,0.005458,0.003313,0.011896,"cudaEventRecord"
"API calls",0.400454,2.401132,402,0.005972,0.003346,0.009972,"cudaStreamWaitEvent"
"API calls",0.343122,2.057366,2009,0.001024,0.000556,0.004307,"cudaGetLastError"
"API calls",0.104691,0.627727,3,0.209242,0.043356,0.516153,"cudaHostRegister"
"API calls",0.083185,0.498781,2,0.249390,0.045814,0.452967,"cudaHostUnregister"
"API calls",0.014804,0.088764,4,0.022191,0.014803,0.026781,"cudaFuncGetAttributes"
"API calls",0.002411,0.014456,4,0.003614,0.002445,0.004184,"cudaGetDevice"
"API calls",0.002077,0.012455,4,0.003113,0.002166,0.003625,"cudaDeviceGetAttribute"
"API calls",0.001561,0.009357,8,0.001169,0.000779,0.001740,"cudaPeekAtLastError"

==25099== NVTX result:
==25099==   Thread "<unnamed>" (id = 312240)
==25099==     Domain "<unnamed>"
==25099==       Range "Allocation of Temporary Vectors"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,82.763537,1,82.763537,82.763537,82.763537,"Allocation of Temporary Vectors"
"GPU activities",100.000000,0.233533,3,0.077844,0.076223,0.080287,"_ZN6thrust8cuda_cub4core13_kernel_agentINS0_14__parallel_for16ParallelForAgentINS0_20__uninitialized_fill7functorINS_10device_ptrIdEEdEEmEES9_mEEvT0_T1_"
"API calls",100.000000,11.287506,3,3.762502,0.085901,11.112448,"cudaLaunchKernel"

==25099==       Range "Create external_local_index"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,12.483476,1,12.483476,12.483476,12.483476,"Create external_local_index"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "MPI All Reduce"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,61.631548,401,0.153694,0.009189,3.418901,"MPI All Reduce"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "MPI Communication"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,27.516169,2,13.758084,0.901617,26.614552,"MPI Communication"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "MPI Reduce"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,40.902881,1,40.902881,40.902881,40.902881,"MPI Reduce"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "Set External Processors"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,34.493533,1,34.493533,34.493533,34.493533,"Set External Processors"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "add to recv_list"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,0.002198,1,0.002198,0.002198,0.002198,"add to recv_list"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "allocate device memory"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,93.958069,1,93.958069,93.958069,93.958069,"allocate device memory"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "allocate host memory"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,197.670025,1,197.670025,197.670025,197.670025,"allocate host memory"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "allocation"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,5.612826,1,5.612826,5.612826,5.612826,"allocation"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "assemble FE data"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,160.697116,1,160.697116,160.697116,160.697116,"assemble FE data"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "assign new external"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,1.713282,2,0.856641,0.235332,1.477950,"assign new external"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "begin exchange"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,20.716665,201,0.103067,0.083914,0.148725,"begin exchange"
"GPU activities",79.443287,15.511456,201,0.077171,0.044159,0.150239,"[CUDA memcpy DtoH]"
"GPU activities",20.556713,4.013738,201,0.019968,0.012000,0.031424,"_ZN6miniFE20copyElementsToBufferIdiEEvPT_S2_PT0_i"
"API calls",58.057802,7.469041,201,0.037159,0.027313,0.049219,"cudaLaunchKernel"
"API calls",41.942198,5.395795,201,0.026844,0.020050,0.047719,"cudaMemcpyAsync"

==25099==       Range "cgsolve"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,1301.110002,1,1301.110002,1301.110002,1301.110002,"cgsolve"
"GPU activities",75.909992,763.167551,201,3.796853,3.789496,3.805336,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE0ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"GPU activities",13.564650,136.373364,602,0.226533,0.155838,0.230141,"_ZN6miniFE13waxpby_kernelINS_9PODVectorIdiiEEEEvNT_10ScalarTypeES3_S4_S3_S3_"
"GPU activities",4.620878,46.456392,400,0.116140,0.082943,0.149662,"_ZN6miniFE10dot_kernelINS_9PODVectorIdiiEEEEvT_S3_PNS_10TypeTraitsINS3_10ScalarTypeEE14magnitude_typeE"
"GPU activities",3.750366,37.704619,201,0.187585,0.184830,0.190462,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE1ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"GPU activities",1.594801,16.033467,601,0.026677,0.001248,0.150239,"[CUDA memcpy DtoH]"
"GPU activities",0.399235,4.013738,201,0.019968,0.012000,0.031424,"_ZN6miniFE20copyElementsToBufferIdiEEvPT_S2_PT0_i"
"GPU activities",0.089217,0.896949,400,0.002242,0.002144,0.002592,"_ZN6miniFE23dot_final_reduce_kernelIdEEvPT_"
"GPU activities",0.047470,0.477243,400,0.001193,0.001120,0.001600,"_ZN6miniFE17cudaMemset_kernelIdEEvPT_S1_i"
"GPU activities",0.023391,0.235165,4,0.058791,0.001632,0.080287,"_ZN6thrust8cuda_cub4core13_kernel_agentINS0_14__parallel_for16ParallelForAgentINS0_20__uninitialized_fill7functorINS_10device_ptrIdEEdEEmEES9_mEEvT0_T1_"
"API calls",85.810713,95.234757,2409,0.039532,0.021447,11.112448,"cudaLaunchKernel"
"API calls",14.189287,15.747606,601,0.026202,0.016851,0.047719,"cudaMemcpyAsync"

==25099==       Range "create recv list"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,1.698108,1,1.698108,1.698108,1.698108,"create recv list"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "create tmp_neighbors"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,2.496447,1,2.496447,2.496447,2.496447,"create tmp_neighbors"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "end exchange"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,907.022871,201,4.512551,1.555952,5.050741,"end exchange"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "exterier region"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,8.100393,201,0.040300,0.029401,0.048775,"exterier region"
"GPU activities",100.000000,37.704619,201,0.187585,0.184830,0.190462,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE1ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"API calls",100.000000,7.269725,201,0.036167,0.025993,0.043674,"cudaLaunchKernel"

==25099==       Range "generate matrix structure"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,320.930462,1,320.930462,320.930462,320.930462,"generate matrix structure"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "impose boundary conditions"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,6.751173,1,6.751173,6.751173,6.751173,"impose boundary conditions"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "interier region"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,8.117295,201,0.040384,0.029657,0.052578,"interier region"
"GPU activities",100.000000,763.167551,201,3.796853,3.789496,3.805336,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE0ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"API calls",100.000000,7.396788,201,0.036799,0.027020,0.047565,"cudaLaunchKernel"

==25099==       Range "make local matrix"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,180.530815,1,180.530815,180.530815,180.530815,"make local matrix"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25099==       Range "reserve space in A"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,95.426576,1,95.426576,95.426576,95.426576,"reserve space in A"
No kernels were profiled in this range.
No API activities were profiled in this range.

