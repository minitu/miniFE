==25098== NVPROF is profiling process 25098, command: ./miniFE.x --num_devices 4 -nx 800 -ny 800 -nz 200
==25098== Profiling application: ./miniFE.x --num_devices 4 -nx 800 -ny 800 -nz 200
==25098== Profiling result:
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"GPU activities",76.055769,760.436005,201,3.783263,3.773704,3.791880,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE0ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"GPU activities",13.618530,136.163510,602,0.226185,0.154719,0.229439,"_ZN6miniFE13waxpby_kernelINS_9PODVectorIdiiEEEEvNT_10ScalarTypeES3_S4_S3_S3_"
"GPU activities",4.639954,46.392116,400,0.115980,0.082783,0.149503,"_ZN6miniFE10dot_kernelINS_9PODVectorIdiiEEEEvT_S3_PNS_10TypeTraitsINS3_10ScalarTypeEE14magnitude_typeE"
"GPU activities",3.756407,37.558062,201,0.186856,0.185183,0.190175,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE1ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"GPU activities",1.299720,12.995121,601,0.021622,0.001280,0.147679,"[CUDA memcpy DtoH]"
"GPU activities",0.466485,4.664099,201,0.023204,0.012672,0.032351,"_ZN6miniFE20copyElementsToBufferIdiEEvPT_S2_PT0_i"
"GPU activities",0.089560,0.895454,400,0.002238,0.002176,0.002528,"_ZN6miniFE23dot_final_reduce_kernelIdEEvPT_"
"GPU activities",0.050158,0.501500,400,0.001253,0.001184,0.001600,"_ZN6miniFE17cudaMemset_kernelIdEEvPT_S1_i"
"GPU activities",0.023418,0.234143,4,0.058535,0.001632,0.080127,"_ZN6thrust8cuda_cub4core13_kernel_agentINS0_14__parallel_for16ParallelForAgentINS0_20__uninitialized_fill7functorINS_10device_ptrIdEEdEEmEES9_mEEvT0_T1_"
"API calls",78.006585,549.006857,601,0.913488,0.035706,3.938943,"cudaEventSynchronize"
"API calls",13.512201,95.098269,2409,0.039476,0.022095,11.134113,"cudaLaunchKernel"
"API calls",3.797557,26.727039,4,6.681759,0.041967,8.961427,"cudaMalloc"
"API calls",2.265883,15.947181,601,0.026534,0.016271,0.050664,"cudaMemcpyAsync"
"API calls",0.983087,6.918925,3,2.306308,2.107661,2.647092,"cudaFree"
"API calls",0.623792,4.390220,802,0.005474,0.003612,0.008816,"cudaEventRecord"
"API calls",0.343630,2.418453,402,0.006016,0.004013,0.010218,"cudaStreamWaitEvent"
"API calls",0.293833,2.067983,2009,0.001029,0.000531,0.005121,"cudaGetLastError"
"API calls",0.085824,0.604024,3,0.201341,0.058978,0.466134,"cudaHostRegister"
"API calls",0.069665,0.490298,2,0.245149,0.036925,0.453373,"cudaHostUnregister"
"API calls",0.012378,0.087118,4,0.021779,0.018880,0.024095,"cudaFuncGetAttributes"
"API calls",0.002334,0.016430,8,0.002053,0.000496,0.005395,"cudaPeekAtLastError"
"API calls",0.001671,0.011761,4,0.002940,0.002795,0.003117,"cudaGetDevice"
"API calls",0.001559,0.010971,4,0.002742,0.002519,0.003101,"cudaDeviceGetAttribute"

==25098== NVTX result:
==25098==   Thread "<unnamed>" (id = 312240)
==25098==     Domain "<unnamed>"
==25098==       Range "Allocation of Temporary Vectors"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,82.817328,1,82.817328,82.817328,82.817328,"Allocation of Temporary Vectors"
"GPU activities",100.000000,0.232511,3,0.077503,0.075968,0.080127,"_ZN6thrust8cuda_cub4core13_kernel_agentINS0_14__parallel_for16ParallelForAgentINS0_20__uninitialized_fill7functorINS_10device_ptrIdEEdEEmEES9_mEEvT0_T1_"
"API calls",100.000000,11.258131,3,3.752710,0.035585,11.134113,"cudaLaunchKernel"

==25098==       Range "Create external_local_index"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,8.330521,1,8.330521,8.330521,8.330521,"Create external_local_index"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "MPI All Reduce"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,60.714146,401,0.151406,0.009923,5.769933,"MPI All Reduce"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "MPI Communication"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,26.398975,2,13.199487,0.696644,25.702331,"MPI Communication"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "MPI Reduce"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,43.233115,1,43.233115,43.233115,43.233115,"MPI Reduce"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "Set External Processors"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,36.092390,1,36.092390,36.092390,36.092390,"Set External Processors"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "add to recv_list"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,0.001654,1,0.001654,0.001654,0.001654,"add to recv_list"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "allocate device memory"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,65.097323,1,65.097323,65.097323,65.097323,"allocate device memory"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "allocate host memory"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,198.540634,1,198.540634,198.540634,198.540634,"allocate host memory"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "allocation"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,5.652002,1,5.652002,5.652002,5.652002,"allocation"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "assemble FE data"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,162.585951,1,162.585951,162.585951,162.585951,"assemble FE data"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "assign new external"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,1.905830,2,0.952915,0.236287,1.669543,"assign new external"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "begin exchange"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,20.627855,201,0.102626,0.086063,0.151232,"begin exchange"
"GPU activities",72.782715,12.472434,201,0.062051,0.044352,0.147679,"[CUDA memcpy DtoH]"
"GPU activities",27.217285,4.664099,201,0.023204,0.012672,0.032351,"_ZN6miniFE20copyElementsToBufferIdiEEvPT_S2_PT0_i"
"API calls",56.892349,7.230864,201,0.035974,0.024917,0.043810,"cudaLaunchKernel"
"API calls",43.107651,5.478866,201,0.027258,0.020661,0.050664,"cudaMemcpyAsync"

==25098==       Range "cgsolve"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,1300.430807,1,1300.430807,1300.430807,1300.430807,"cgsolve"
"GPU activities",76.055769,760.436005,201,3.783263,3.773704,3.791880,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE0ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"GPU activities",13.618530,136.163510,602,0.226185,0.154719,0.229439,"_ZN6miniFE13waxpby_kernelINS_9PODVectorIdiiEEEEvNT_10ScalarTypeES3_S4_S3_S3_"
"GPU activities",4.639954,46.392116,400,0.115980,0.082783,0.149503,"_ZN6miniFE10dot_kernelINS_9PODVectorIdiiEEEEvT_S3_PNS_10TypeTraitsINS3_10ScalarTypeEE14magnitude_typeE"
"GPU activities",3.756407,37.558062,201,0.186856,0.185183,0.190175,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE1ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"GPU activities",1.299720,12.995121,601,0.021622,0.001280,0.147679,"[CUDA memcpy DtoH]"
"GPU activities",0.466485,4.664099,201,0.023204,0.012672,0.032351,"_ZN6miniFE20copyElementsToBufferIdiEEvPT_S2_PT0_i"
"GPU activities",0.089560,0.895454,400,0.002238,0.002176,0.002528,"_ZN6miniFE23dot_final_reduce_kernelIdEEvPT_"
"GPU activities",0.050158,0.501500,400,0.001253,0.001184,0.001600,"_ZN6miniFE17cudaMemset_kernelIdEEvPT_S1_i"
"GPU activities",0.023418,0.234143,4,0.058535,0.001632,0.080127,"_ZN6thrust8cuda_cub4core13_kernel_agentINS0_14__parallel_for16ParallelForAgentINS0_20__uninitialized_fill7functorINS_10device_ptrIdEEdEEmEES9_mEEvT0_T1_"
"API calls",85.639050,95.098269,2409,0.039476,0.022095,11.134113,"cudaLaunchKernel"
"API calls",14.360950,15.947181,601,0.026534,0.016271,0.050664,"cudaMemcpyAsync"

==25098==       Range "create recv list"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,1.667632,1,1.667632,1.667632,1.667632,"create recv list"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "create tmp_neighbors"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,2.623769,1,2.623769,2.623769,2.623769,"create tmp_neighbors"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "end exchange"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,910.072896,201,4.527725,1.380415,5.462040,"end exchange"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "exterier region"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,8.344368,201,0.041514,0.029106,0.056872,"exterier region"
"GPU activities",100.000000,37.558062,201,0.186856,0.185183,0.190175,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE1ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"API calls",100.000000,7.493354,201,0.037280,0.026084,0.052486,"cudaLaunchKernel"

==25098==       Range "generate matrix structure"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,317.470930,1,317.470930,317.470930,317.470930,"generate matrix structure"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "impose boundary conditions"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,6.396675,1,6.396675,6.396675,6.396675,"impose boundary conditions"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "interier region"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,8.095474,201,0.040275,0.030415,0.049658,"interier region"
"GPU activities",100.000000,760.436005,201,3.783263,3.773704,3.791880,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE0ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"API calls",100.000000,7.362447,201,0.036629,0.027706,0.045291,"cudaLaunchKernel"

==25098==       Range "make local matrix"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,186.843581,1,186.843581,186.843581,186.843581,"make local matrix"
No kernels were profiled in this range.
No API activities were profiled in this range.

==25098==       Range "reserve space in A"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,97.454366,1,97.454366,97.454366,97.454366,"reserve space in A"
No kernels were profiled in this range.
No API activities were profiled in this range.

