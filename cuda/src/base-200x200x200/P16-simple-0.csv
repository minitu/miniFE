==96152== NVPROF is profiling process 96152, command: ./miniFE.x --num_devices 4 -nx 800 -ny 800 -nz 200
==96152== Profiling application: ./miniFE.x --num_devices 4 -nx 800 -ny 800 -nz 200
==96152== Profiling result:
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"GPU activities",76.714599,761.868459,201,3.790390,3.783361,3.797122,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE0ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"GPU activities",13.728567,136.341224,602,0.226480,0.154175,0.230334,"_ZN6miniFE13waxpby_kernelINS_9PODVectorIdiiEEEEvNT_10ScalarTypeES3_S4_S3_S3_"
"GPU activities",4.678799,46.466117,400,0.116165,0.083072,0.149791,"_ZN6miniFE10dot_kernelINS_9PODVectorIdiiEEEEvT_S3_PNS_10TypeTraitsINS3_10ScalarTypeEE14magnitude_typeE"
"GPU activities",3.253659,32.312759,201,0.160759,0.159102,0.163678,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE1ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"GPU activities",1.091462,10.839531,601,0.018035,0.001279,0.128127,"[CUDA memcpy DtoH]"
"GPU activities",0.368987,3.664484,201,0.018231,0.009088,0.025248,"_ZN6miniFE20copyElementsToBufferIdiEEvPT_S2_PT0_i"
"GPU activities",0.091090,0.904635,400,0.002261,0.002176,0.002624,"_ZN6miniFE23dot_final_reduce_kernelIdEEvPT_"
"GPU activities",0.049621,0.492799,400,0.001231,0.001183,0.001408,"_ZN6miniFE17cudaMemset_kernelIdEEvPT_S1_i"
"GPU activities",0.023216,0.230558,4,0.057639,0.001312,0.077887,"_ZN6thrust8cuda_cub4core13_kernel_agentINS0_14__parallel_for16ParallelForAgentINS0_20__uninitialized_fill7functorINS_10device_ptrIdEEdEEmEES9_mEEvT0_T1_"
"API calls",77.130442,524.688521,601,0.873025,0.015300,4.017872,"cudaEventSynchronize"
"API calls",13.816524,93.988464,2409,0.039015,0.020655,11.034872,"cudaLaunchKernel"
"API calls",3.904529,26.561000,4,6.640250,0.031122,8.858114,"cudaMalloc"
"API calls",2.324100,15.809955,601,0.026306,0.015877,0.036131,"cudaMemcpyAsync"
"API calls",1.354934,9.217089,3,3.072363,2.208963,3.789786,"cudaFree"
"API calls",0.642440,4.370273,802,0.005449,0.003343,0.007666,"cudaEventRecord"
"API calls",0.352954,2.401010,402,0.005972,0.003742,0.010654,"cudaStreamWaitEvent"
"API calls",0.303996,2.067964,2009,0.001029,0.000543,0.001754,"cudaGetLastError"
"API calls",0.080910,0.550400,3,0.183466,0.048235,0.443335,"cudaHostRegister"
"API calls",0.072536,0.493433,2,0.246716,0.043340,0.450093,"cudaHostUnregister"
"API calls",0.011260,0.076597,4,0.019149,0.015628,0.024851,"cudaFuncGetAttributes"
"API calls",0.002083,0.014171,8,0.001771,0.000791,0.006484,"cudaPeekAtLastError"
"API calls",0.001716,0.011673,4,0.002918,0.002566,0.003451,"cudaGetDevice"
"API calls",0.001575,0.010713,4,0.002678,0.002028,0.003189,"cudaDeviceGetAttribute"

==96152== NVTX result:
==96152==   Thread "<unnamed>" (id = 312240)
==96152==     Domain "<unnamed>"
==96152==       Range "Allocation of Temporary Vectors"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,82.959631,1,82.959631,82.959631,82.959631,"Allocation of Temporary Vectors"
"GPU activities",100.000000,0.229246,3,0.076415,0.075391,0.077887,"_ZN6thrust8cuda_cub4core13_kernel_agentINS0_14__parallel_for16ParallelForAgentINS0_20__uninitialized_fill7functorINS_10device_ptrIdEEdEEmEES9_mEEvT0_T1_"
"API calls",100.000000,11.200912,3,3.733637,0.057933,11.034872,"cudaLaunchKernel"

==96152==       Range "Create external_local_index"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,2.120218,1,2.120218,2.120218,2.120218,"Create external_local_index"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "MPI All Reduce"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,134.330630,401,0.334989,0.012880,47.001452,"MPI All Reduce"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "MPI Communication"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,26.396581,2,13.198290,0.998348,25.398233,"MPI Communication"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "MPI Reduce"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,64.750536,1,64.750536,64.750536,64.750536,"MPI Reduce"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "Set External Processors"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,3.545445,1,3.545445,3.545445,3.545445,"Set External Processors"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "add to recv_list"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,0.001215,1,0.001215,0.001215,0.001215,"add to recv_list"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "allocate device memory"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,91.007629,1,91.007629,91.007629,91.007629,"allocate device memory"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "allocate host memory"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,203.490773,1,203.490773,203.490773,203.490773,"allocate host memory"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "allocation"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,5.175017,1,5.175017,5.175017,5.175017,"allocation"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "assemble FE data"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,159.782565,1,159.782565,159.782565,159.782565,"assemble FE data"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "assign new external"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,1.052779,2,0.526389,0.156953,0.895826,"assign new external"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "begin exchange"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,20.367343,201,0.101330,0.084735,0.137555,"begin exchange"
"GPU activities",73.796523,10.320240,201,0.051344,0.025568,0.128127,"[CUDA memcpy DtoH]"
"GPU activities",26.203477,3.664484,201,0.018231,0.009088,0.025248,"_ZN6miniFE20copyElementsToBufferIdiEEvPT_S2_PT0_i"
"API calls",56.514938,7.169797,201,0.035670,0.025850,0.050775,"cudaLaunchKernel"
"API calls",43.485062,5.516755,201,0.027446,0.020489,0.036131,"cudaMemcpyAsync"

==96152==       Range "cgsolve"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,1302.575803,1,1302.575803,1302.575803,1302.575803,"cgsolve"
"GPU activities",76.714599,761.868459,201,3.790390,3.783361,3.797122,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE0ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"GPU activities",13.728567,136.341224,602,0.226480,0.154175,0.230334,"_ZN6miniFE13waxpby_kernelINS_9PODVectorIdiiEEEEvNT_10ScalarTypeES3_S4_S3_S3_"
"GPU activities",4.678799,46.466117,400,0.116165,0.083072,0.149791,"_ZN6miniFE10dot_kernelINS_9PODVectorIdiiEEEEvT_S3_PNS_10TypeTraitsINS3_10ScalarTypeEE14magnitude_typeE"
"GPU activities",3.253659,32.312759,201,0.160759,0.159102,0.163678,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE1ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"GPU activities",1.091462,10.839531,601,0.018035,0.001279,0.128127,"[CUDA memcpy DtoH]"
"GPU activities",0.368987,3.664484,201,0.018231,0.009088,0.025248,"_ZN6miniFE20copyElementsToBufferIdiEEvPT_S2_PT0_i"
"GPU activities",0.091090,0.904635,400,0.002261,0.002176,0.002624,"_ZN6miniFE23dot_final_reduce_kernelIdEEvPT_"
"GPU activities",0.049621,0.492799,400,0.001231,0.001183,0.001408,"_ZN6miniFE17cudaMemset_kernelIdEEvPT_S1_i"
"GPU activities",0.023216,0.230558,4,0.057639,0.001312,0.077887,"_ZN6thrust8cuda_cub4core13_kernel_agentINS0_14__parallel_for16ParallelForAgentINS0_20__uninitialized_fill7functorINS_10device_ptrIdEEdEEmEES9_mEEvT0_T1_"
"API calls",85.600927,93.988464,2409,0.039015,0.020655,11.034872,"cudaLaunchKernel"
"API calls",14.399073,15.809955,601,0.026306,0.015877,0.036131,"cudaMemcpyAsync"

==96152==       Range "create recv list"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,0.970870,1,0.970870,0.970870,0.970870,"create recv list"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "create tmp_neighbors"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,1.361783,1,1.361783,1.361783,1.361783,"create tmp_neighbors"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "end exchange"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,879.536745,201,4.375804,1.187932,5.458919,"end exchange"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "exterier region"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,8.126555,201,0.040430,0.029138,0.048980,"exterier region"
"GPU activities",100.000000,32.312759,201,0.160759,0.159102,0.163678,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE1ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"API calls",100.000000,7.289550,201,0.036266,0.026103,0.044094,"cudaLaunchKernel"

==96152==       Range "generate matrix structure"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,491.006434,1,491.006434,491.006434,491.006434,"generate matrix structure"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "impose boundary conditions"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,12.580868,1,12.580868,12.580868,12.580868,"impose boundary conditions"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "interier region"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,7.936557,201,0.039485,0.032168,0.047910,"interier region"
"GPU activities",100.000000,761.868459,201,3.790390,3.783361,3.797122,"_ZN6miniFE25matvec_overlap_ell_kernelILNS_12MATVEC_RANGEE0ENS_12PODELLMatrixIdiiEENS_9PODVectorIdiiEEEEvT0_T1_S7_"
"API calls",100.000000,7.215577,201,0.035898,0.029393,0.043936,"cudaLaunchKernel"

==96152==       Range "make local matrix"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,170.561320,1,170.561320,170.561320,170.561320,"make local matrix"
No kernels were profiled in this range.
No API activities were profiled in this range.

==96152==       Range "reserve space in A"
"Type","Time(%)","Time","Calls","Avg","Min","Max","Name"
,%,ms,,ms,ms,ms,
"Range:",100.000000,92.935557,1,92.935557,92.935557,92.935557,"reserve space in A"
No kernels were profiled in this range.
No API activities were profiled in this range.

